# IB Portfolio Analyzer Chrome æ‰©å±•

ä¸€ä¸ª Chrome æµè§ˆå™¨æ‰©å±•ï¼Œé€šè¿‡ Native Messaging ä¸æœ¬åœ° IB API é€šä¿¡ï¼Œå®æ—¶è·å–å’Œæ˜¾ç¤º Interactive Brokers è´¦æˆ·æ•°æ®ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“Š **è´¦æˆ·æ¦‚è§ˆ**: æ˜¾ç¤ºè´¦æˆ·å‡€å€¼ã€æœªå®ç°ç›ˆäºã€æ—¥ç›ˆäº
- ğŸ“ˆ **å¸Œè…Šå€¼åˆ†æ**: Deltaã€Gammaã€Thetaã€Vega æ±‡æ€»åŠç¾å…ƒå€¼
- âš ï¸ **é£é™©è¯„ä¼°**: é£é™©ç­‰çº§ã€VaR (95%)ã€æœ€å¤§æŸå¤±æ¦‚ç‡
- ğŸ’¡ **æŠ•èµ„å»ºè®®**: åŸºäºå½“å‰æŒä»“çš„æ™ºèƒ½å»ºè®®
- ğŸ“‹ **æŒä»“åˆ—è¡¨**: å¿«é€ŸæŸ¥çœ‹æ‰€æœ‰æŒä»“å’Œç›ˆäº

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chrome æ‰©å±•    â”‚ â—„â”€â”€â”€â”€â”€â–º â”‚  Native Host    â”‚ â—„â”€â”€â”€â”€â”€â–º â”‚  TWS/IB Gateway â”‚
â”‚  (popup.js)     â”‚  stdio  â”‚  (Python)       â”‚   API   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…æ­¥éª¤

### 1. å®‰è£… Chrome æ‰©å±•

1. æ‰“å¼€ Chrome æµè§ˆå™¨ï¼Œè®¿é—® `chrome://extensions/`
2. å¼€å¯å³ä¸Šè§’çš„ **"å¼€å‘è€…æ¨¡å¼"**
3. ç‚¹å‡» **"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"**
4. é€‰æ‹© `extension` ç›®å½•

### 2. è®°å½•æ‰©å±• ID

å®‰è£…åï¼Œæ‰©å±•ä¼šæ˜¾ç¤ºä¸€ä¸ªç±»ä¼¼ `abcdefghijklmnopqrstuvwxyz012345` çš„ IDï¼Œè®°ä¸‹è¿™ä¸ª IDã€‚

### 3. æ³¨å†Œ Native Host

è¿è¡Œå®‰è£…è„šæœ¬ï¼š

```bash
cd extension
./install.sh
```

æŒ‰æç¤ºè¾“å…¥ä¸Šä¸€æ­¥è®°å½•çš„æ‰©å±• IDã€‚

### 4. å¯åŠ¨ TWS/IB Gateway

ç¡®ä¿ TWS æˆ– IB Gateway æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”ï¼š
- API å·²å¯ç”¨ï¼ˆé…ç½® â†’ API â†’ è®¾ç½® â†’ å¯ç”¨ ActiveX å’Œ Socket å®¢æˆ·ç«¯ï¼‰
- ç«¯å£è®¾ç½®ä¸º 7497 (TWS) æˆ– 4001 (Gateway)

### 5. ä½¿ç”¨æ‰©å±•

ç‚¹å‡» Chrome å·¥å…·æ ä¸­çš„æ‰©å±•å›¾æ ‡å³å¯æŸ¥çœ‹æ•°æ®ã€‚

## æ–‡ä»¶ç»“æ„

```
extension/
â”œâ”€â”€ manifest.json           # æ‰©å±•æ¸…å•
â”œâ”€â”€ popup.html              # å¼¹çª— HTML
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ popup.js            # å¼¹çª—é€»è¾‘
â”‚   â”œâ”€â”€ popup.css           # æ ·å¼
â”‚   â””â”€â”€ background.js       # åå°æœåŠ¡
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon16.png
â”‚   â”œâ”€â”€ icon32.png
â”‚   â”œâ”€â”€ icon48.png
â”‚   â””â”€â”€ icon128.png
â”œâ”€â”€ native-host/
â”‚   â”œâ”€â”€ ib_native_host.py   # Native Host è„šæœ¬
â”‚   â”œâ”€â”€ com.ib.portfolio_analyzer.json  # Host æ¸…å•
â”‚   â””â”€â”€ logs/               # æ—¥å¿—ç›®å½•
â”œâ”€â”€ install.sh              # å®‰è£…è„šæœ¬
â”œâ”€â”€ uninstall.sh            # å¸è½½è„šæœ¬
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

## å¼€å‘æ¨¡å¼

### è°ƒè¯•æ‰©å±•

1. æ‰“å¼€ `chrome://extensions/`
2. æ‰¾åˆ°æ‰©å±•ï¼Œç‚¹å‡» **"èƒŒæ™¯é¡µé¢"** æˆ– **"Service Worker"** æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

### è°ƒè¯• Native Host

æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š
```bash
tail -f extension/native-host/logs/native_host.log
```

### æµ‹è¯• Native Host

```bash
# å‘é€æµ‹è¯•æ¶ˆæ¯
echo '{"action":"ping"}' | python3 extension/native-host/ib_native_host.py
```

## é…ç½®é€‰é¡¹

### ä¿®æ”¹ IB è¿æ¥å‚æ•°

ç¼–è¾‘ `src/ib_client/client.py` ä¸­çš„è¿æ¥å‚æ•°ï¼š

```python
HOST = "127.0.0.1"
PORT = 7497  # TWS: 7497, Gateway: 4001
CLIENT_ID = 1
```

## æ•…éšœæ’é™¤

### æ‰©å±•æ˜¾ç¤º "è¿æ¥æ–­å¼€"

1. ç¡®ä¿ TWS/IB Gateway æ­£åœ¨è¿è¡Œ
2. ç¡®ä¿ API å·²å¯ç”¨
3. æ£€æŸ¥ Native Host æ—¥å¿—

### Native Host é”™è¯¯

1. ç¡®ä¿ Python 3.7+ å·²å®‰è£…
2. ç¡®ä¿é¡¹ç›®ä¾èµ–å·²å®‰è£…: `pip install -r requirements.txt`
3. æ£€æŸ¥æ–‡ä»¶æƒé™: `chmod +x extension/native-host/ib_native_host.py`

### é‡æ–°å®‰è£… Native Host

```bash
./extension/uninstall.sh
./extension/install.sh
```

## å¸è½½

1. åœ¨ `chrome://extensions/` ç§»é™¤æ‰©å±•
2. è¿è¡Œå¸è½½è„šæœ¬:
   ```bash
   ./extension/uninstall.sh
   ```

## è®¸å¯è¯

MIT License
